<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acropolis Realty - Mapa Profesional</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body { margin: 0; padding: 0; font-family: sans-serif; }
        #mi-mapa { height: 100vh; width: 100%; position: absolute; }
        
        /* Contenedor de Filtros */
        .filtros-wrapper {
            position: absolute; top: 10px; left: 10px; z-index: 1000;
            display: flex; flex-direction: column; gap: 5px;
        }
        .grupo {
            background: rgba(255, 255, 255, 0.9); padding: 5px;
            border-radius: 8px; display: flex; gap: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .filter-btn {
            background: white; border: 1px solid #ccc; padding: 5px 10px;
            border-radius: 15px; font-size: 11px; cursor: pointer; font-weight: bold;
        }
        .active { background: #d32f2f; color: white; border-color: #d32f2f; }

        /* Popups */
        .popup-ficha { width: 200px; text-align: center; }
        .popup-ficha img { width: 100%; border-radius: 5px; height: 120px; object-fit: cover; }
        .precio { color: #d32f2f; font-weight: bold; font-size: 15px; margin: 5px 0; display: block; }
        .etiqueta { font-size: 10px; font-weight: bold; text-transform: uppercase; padding: 2px 5px; border-radius: 3px; color: white; }
        .arriendo { background: #2196F3; }
        .venta { background: #4CAF50; }
        .btn { display: block; padding: 8px; margin-top: 5px; border-radius: 5px; text-decoration: none; color: white !important; font-weight: bold; font-size: 12px; }
    </style>
</head>
<body>

    <div class="filtros-wrapper">
        <div class="grupo" id="uso">
            <button class="filter-btn active" onclick="filtrar('todos', 'uso', this)">Todos</button>
            <button class="filter-btn" onclick="filtrar('local', 'uso', this)">Locales</button>
            <button class="filter-btn" onclick="filtrar('bodega', 'uso', this)">Bodegas</button>
        </div>
        <div class="grupo" id="negocio">
            <button class="filter-btn active" onclick="filtrar('todos', 'negocio', this)">Todo</button>
            <button class="filter-btn" onclick="filtrar('arriendo', 'negocio', this)">Arriendo</button>
            <button class="filter-btn" onclick="filtrar('venta', 'negocio', this)">Venta</button>
        </div>
    </div>

    <div id="mi-mapa"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // 1. Inicializar Mapa
        var map = L.map('mi-mapa').setView([10.9750, -74.8100], 13);
        L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

        // 2. Datos
        var locales = [
            { nombre: "trupillo", tipo: "local", negocio: "arriendo", precio: "2.500.000", coords: [10.9588, -74.7846], foto: "trupillo.jpg", area: "59mt¬≤" },
            { nombre: "Local Universidad", tipo: "local", negocio: "venta", precio: "350.000.000", coords: [10.9927, -74.7936], foto: "universidad.jpg", area: "45mt¬≤" },
            { nombre: "Bodega Prado", tipo: "bodega", negocio: "arriendo", precio: "4.500.000", coords: [10.9968, -74.7961], foto: "bodega.jpg", area: "200mt¬≤" },
            { nombre: "Local Calle 30", tipo: "local", negocio: "arriendo", precio: "1.200.000", coords: [10.9634, -74.8396], foto: "pueblito.jpg", area: "35mt¬≤" }
        ];

        var capaMarcadores = L.layerGroup().addTo(map);
        var fUso = 'todos';
        var fNegocio = 'todos';

        function dibujar() {
            capaMarcadores.clearLayers();
            locales.forEach(function(l) {
                var cUso = (fUso === 'todos' || l.tipo === fUso);
                var cNegocio = (fNegocio === 'todos' || l.negocio === fNegocio);

                if (cUso && cNegocio) {
                    var marker = L.marker(l.coords);
                    marker.bindPopup(`
                        <div class="popup-ficha">
                            <img src="${l.foto}">
                            <br><span class="etiqueta ${l.negocio}">${l.negocio}</span>
                            <h3 style="margin:5px 0">${l.nombre}</h3>
                            <span class="precio">$ ${l.precio}</span>
                            <div style="font-size:11px; color:#666">üìè √Årea: ${l.area}</div>
                            <a href="https://www.google.com/maps/dir/?api=1&destination=${l.coords[0]},${l.coords[1]}" target="_blank" class="btn" style="background:#4285F4">üìç C√≥mo llegar</a>
                            <a href="https://wa.me/573243816458" target="_blank" class="btn" style="background:#25d366">üí¨ WhatsApp</a>
                        </div>
                    `);
                    capaMarcadores.addLayer(marker);
                }
            });
        }

        function filtrar(val, cat, btn) {
            // Quitar clase active de los botones del mismo grupo
            var parent = btn.parentElement;
            var hijos = parent.querySelectorAll('.filter-btn');
            hijos.forEach(function(h) { h.classList.remove('active'); });
            btn.classList.add('active');

            if (cat === 'uso') { fUso = val; } 
            else { fNegocio = val; }
            dibujar();
        }

        dibujar();
    </script>
</body>
</html>
